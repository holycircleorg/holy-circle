<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Holy Circle | Analytics</title>

  <!-- Styles -->
  <link rel="stylesheet" href="admin.css" />
  <link rel="stylesheet" href="admin-layout.css" />
  <link rel="stylesheet" href="admin-analytics.css" />
  <link rel="stylesheet" href="admin-analytics-realtime.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&display=swap" rel="stylesheet">

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Admin Scripts -->
  <script defer src="admin-layout.js"></script>
  <script defer src="admin-analytics.js"></script>
</head>

<body>
<script>
  document.body.classList.add("with-sidebar");
</script>

<!-- SIDEBAR -->
<aside class="admin-sidebar">
  <div class="sidebar-header">
    <h2>HOLY CIRCLE</h2>
    <button id="sidebarToggle" class="sidebar-toggle">‚ò∞</button>
  </div>

  <ul class="sidebar-menu">
    <li><a href="admin-dashboard.html"><i class="icon">üè†</i><span>Dashboard</span></a></li>
    <li><a href="admin-people.html"><i class="icon">üë•</i><span>People</span></a></li>
    <li><a href="admin-donors.html"><i class="icon">üíõ</i><span>Donors</span></a></li>
    <li><a href="admin-events.html"><i class="icon">üìÖ</i><span>Events</span></a></li>
    <li><a href="admin-podcast.html"><i class="icon">üéôÔ∏è</i><span>Podcast</span></a></li>
    <li><a href="admin-moderation.html"><i class="icon">üóíÔ∏è</i><span>Forums</span></a></li>
    <li><a href="admin-news.html"><i class="icon">üì∞</i><span>News</span></a></li>
    <li class="active"><a href="admin-analytics.html"><i class="icon">üìä</i><span>Analytics</span></a></li>
    <li><a href="admin-email.html"><i class="icon">‚úâÔ∏è</i><span>Email</span></a></li>
    <li><a href="admin-users.html"><i class="icon">üõÇ</i><span>Users</span></a></li>
    <li><a href="admin-settings.html"><i class="icon">‚öôÔ∏è</i><span>Settings</span></a></li>
  </ul>

  <div class="sidebar-footer">
    <a href="#" onclick="adminLogout()" class="logout-link">
      <i class="icon">üö™</i><span>Logout</span>
    </a>
  </div>
</aside>

<!-- TOP HEADER -->
<header class="admin-header">
  <div class="header-left">
    <div class="mobile-menu-trigger" id="mobileMenuTrigger">
      <i class="fa-solid fa-bars"></i>
    </div>
  </div>

  <div class="header-center">
    <h1>Analytics</h1>
  </div>

  <div class="header-right">
    <div class="simple-user-text">
      <strong id="headerName">Loading‚Ä¶</strong>
      <small id="headerRole"></small>
    </div>
  </div>
</header>

<!-- MOBILE NAV -->
<div class="mobile-nav-dropdown" id="mobileNavDropdown">
  <a href="admin-dashboard.html">Dashboard</a>
  <a href="admin-people.html">People</a>
  <a href="admin-donors.html">Donors</a>
  <a href="admin-events.html">Events</a>
  <a href="admin-podcast.html">Podcast</a>
  <a href="admin-news.html">News</a>
  <a href="admin-analytics.html">Analytics</a>
  <a href="admin-email.html">Email</a>
  <a href="admin-users.html">Users</a>
  <a href="admin-settings.html">Settings</a>
</div>

<!-- MAIN -->
<main class="admin-main">
  <div class="admin-container">

            <!-- PAGE HEADER -->
            <section class="rt-header">
                <div>
                  <h1>Realtime Analytics</h1>
                  <p class="rt-subtitle">
                    Live view of visitors, devices, and event funnels in the last 5 minutes.
                  </p>
                </div>
                <div class="rt-status">
                  <span id="rtStatusDot" class="rt-dot rt-dot-offline"></span>
                  <span id="rtStatusText">Connecting‚Ä¶</span>
                </div>
              </section>
      
              <!-- TOP ROW: LIVE VISITORS + DEVICES -->
              <section class="rt-top-row">
                <div class="rt-card">
                  <div class="rt-card-header">
                    <h2>Active Visitors</h2>
                    <span class="rt-pill">Last 5 minutes</span>
                  </div>
                  <div class="rt-active-count">
                    <span id="rtActiveVisitors">0</span>
                    <small>
                      <span id="rtMembersOnline">0</span> members ¬∑
                      <span id="rtGuestsOnline">0</span> guests
                    </small>
                  </div>
                </div>
      
                <div class="rt-card">
                  <div class="rt-card-header">
                    <h2>Devices</h2>
                  </div>
                  <div class="rt-device-bars">
                    <div class="rt-device-row">
                      <span>Mobile</span>
                      <div class="rt-bar-wrapper">
                        <div id="rtBarMobile" class="rt-bar"></div>
                      </div>
                      <span id="rtMobileCount" class="rt-bar-count">0</span>
                    </div>
                    <div class="rt-device-row">
                      <span>Desktop</span>
                      <div class="rt-bar-wrapper">
                        <div id="rtBarDesktop" class="rt-bar"></div>
                      </div>
                      <span id="rtDesktopCount" class="rt-bar-count">0</span>
                    </div>
                    <div class="rt-device-row">
                      <span>Tablet</span>
                      <div class="rt-bar-wrapper">
                        <div id="rtBarTablet" class="rt-bar"></div>
                      </div>
                      <span id="rtTabletCount" class="rt-bar-count">0</span>
                    </div>
                    <div class="rt-device-row">
                      <span>Other</span>
                      <div class="rt-bar-wrapper">
                        <div id="rtBarOther" class="rt-bar"></div>
                      </div>
                      <span id="rtOtherCount" class="rt-bar-count">0</span>
                    </div>
                  </div>
                </div>
              </section>
      
              <!-- MIDDLE: LIVE ACTIVITY FEED -->
              <section class="rt-card rt-feed-card">
                <div class="rt-card-header">
                  <h2>Live Activity</h2>
                  <span class="rt-pill">Latest page views</span>
                </div>
                <ul id="rtActivityFeed" class="rt-feed-list">
                  <li class="rt-feed-empty">Waiting for events‚Ä¶</li>
                </ul>
              </section>
      
              <!-- BOTTOM: EVENT FUNNEL -->
              <section class="rt-card rt-funnel-card">
                <div class="rt-card-header">
                  <h2>Event Funnel (Last 5 minutes)</h2>
                </div>
                <div class="rt-funnel-grid">
                  <div class="rt-funnel-step">
                    <p class="rt-funnel-label">Event Page Views</p>
                    <p id="rtFunnelViews" class="rt-funnel-value">0</p>
                  </div>
                  <div class="rt-funnel-step">
                    <p class="rt-funnel-label">RSVP Opens</p>
                    <p id="rtFunnelOpens" class="rt-funnel-value">0</p>
                  </div>
                  <div class="rt-funnel-step">
                    <p class="rt-funnel-label">RSVPs</p>
                    <p id="rtFunnelRsvps" class="rt-funnel-value">0</p>
                  </div>
                  <div class="rt-funnel-step">
                    <p class="rt-funnel-label">New Members</p>
                    <p id="rtFunnelMembers" class="rt-funnel-value">0</p>
                  </div>
                </div>
              </section>


    <!-- ========== TOP METRICS (Giving + Community) ========== -->
    <section class="panel">
      <div class="metrics-grid">

        <a href="admin-donors.html" class="metric-card-link">
          <div class="metric-card">
            <h3>Total Given</h3>
            <p id="statTotalGiven">$0</p>
            <span class="metric-meta">All-time giving</span>
          </div>
        </a>

        <a href="admin-donors.html" class="metric-card-link">
          <div class="metric-card">
            <h3>Recurring</h3>
            <p id="statRecurring">$0</p>
            <span class="metric-meta">Active monthly partners</span>
          </div>
        </a>

        <a href="admin-donations.html" class="metric-card-link">
          <div class="metric-card">
            <h3>Monthly Giving</h3>
            <p id="metricMonthlyGiving">$0</p>
            <span class="metric-meta">Last completed month</span>
          </div>
        </a>

        <a href="admin-email.html" class="metric-card-link">
          <div class="metric-card">
            <h3>Community Growth</h3>
            <p id="metricEmailSignups">0 signups</p>
            <span class="metric-meta" id="metricMembersCount">0 members</span>
          </div>
        </a>
        <a href="admin-email.html" class="metric-card-link">
  <div class="metric-card">
    <h3>Forum Waitlist</h3>
    <p id="metricForumWaitlist">0</p>
    <span class="metric-meta">Waiting for forum launch</span>
  </div>
</a>



      </div>
    </section>

    <!-- ========== GIVING ANALYTICS ========== -->
    <section class="panel tall-panel">
      <div class="panel-header">
        <h2>Giving Analytics</h2>
        <div class="chip-group" id="givingModeButtons">
          <button data-mode="monthly" class="chip chip-active">Monthly</button>
          <button data-mode="daily" class="chip">Daily</button>
        </div>
      </div>
      <canvas id="givingChart" height="140"></canvas>
    </section>

    <!-- ========== EMAIL & MEMBER GROWTH ========== -->
    <section class="panel tall-panel">
      <div class="panel-header">
        <h2>Email & Member Growth</h2>
      </div>
      <canvas id="growthChart" height="140"></canvas>
    </section>

    <!-- ========== PEOPLE GROWTH TIMELINE ========== -->
    <section class="panel tall-panel">
      <div class="panel-header">
        <h2>People Growth Timeline</h2>
        <span class="panel-subtitle">New members over the last 6 months</span>
      </div>
      <canvas id="peopleChart" height="140"></canvas>
    </section>

<!-- ========== EVENT RSVP ANALYTICS ========== -->
<section class="panel tall-panel">
    <div class="panel-header">
      <h2>Event RSVP Analytics</h2>
      <span class="panel-subtitle">RSVPs over the last 7 days</span>
    </div>
    <canvas id="rsvpAnalyticsChart" height="140"></canvas>
  </section>

  <section class="panel tall-panel">
    <div class="panel-header">
      <h2>Top Events by RSVPs</h2>
      <span class="panel-subtitle">Most engaged events</span>
    </div>
    <table class="analytics-table">
      <thead>
        <tr>
          <th>Event</th>
          <th>Type</th>
          <th>RSVPs</th>
        </tr>
      </thead>
      <tbody id="topEventsTable"></tbody>
    </table>
  </section>
  
  <section class="panel tall-panel">
    <div class="panel-header">
      <h2>RSVP Leaderboard</h2>
      <span class="panel-subtitle">Events ranked by total RSVPs</span>
    </div>
    <canvas id="leaderboardChart" height="140"></canvas>
  </section>

  <section class="panel tall-panel">
    <div class="panel-header">
      <h2>RSVPs by Type</h2>
      <span class="panel-subtitle">Worship, outreach, online, special</span>
    </div>
    <canvas id="rsvpTypeChart" height="140"></canvas>
  </section>

  <section class="panel tall-panel">
    <div class="panel-header">
      <h2>Event Conversion Rates</h2>
      <span class="panel-subtitle">Page views vs RSVPs</span>
    </div>
    <table class="analytics-table">
      <thead>
        <tr>
          <th>Event</th>
          <th>Views</th>
          <th>RSVPs</th>
          <th>Conversion Rate</th>
        </tr>
      </thead>
      <tbody id="conversionTable"></tbody>
    </table>
  </section>
  
  
  
    <!-- ========== PODCAST ANALYTICS ========== -->
    <section class="panel tall-panel">
      <div class="panel-header">
        <h2>Podcast Analytics</h2>
      </div>

      <div class="stats-row">
        <div class="mini-stat">
          <h4>Total Episodes</h4>
          <p id="podcastTotalEpisodes">0</p>
        </div>
        <div class="mini-stat">
          <h4>Published</h4>
          <p id="podcastPublished">0</p>
        </div>
        <div class="mini-stat">
          <h4>Drafts</h4>
          <p id="podcastDrafts">0</p>
        </div>
      </div>

      <div class="chart-wrapper">
        <h3 class="chart-title">Episodes Published Per Month</h3>
        <canvas id="podcastChart" height="120"></canvas>
      </div>
    </section>

    <!-- ========== TRAFFIC ANALYTICS ========== -->
    <section class="panel tall-panel">
      <div class="panel-header">
        <h2>Traffic Overview</h2>
        <span class="panel-subtitle">Page views over the last 30 days</span>
      </div>
      <canvas id="trafficChart" height="140"></canvas>
    </section>

    <section class="panel">
      <div class="panel-header">
        <h2>Top Pages & Referrers</h2>
      </div>

      <div class="analytics-two-column">
        <!-- Top Pages -->
        <div class="sub-panel">
          <h3 class="sub-panel-title">Top Pages</h3>
          <div class="table-wrapper">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Path</th>
                  <th>Views</th>
                </tr>
              </thead>
              <tbody id="trafficPagesBody">
                <tr><td colspan="2">Loading‚Ä¶</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <!-- Top Referrers -->
        <div class="sub-panel">
          <h3 class="sub-panel-title">Top Referrers</h3>
          <div class="table-wrapper">
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Referrer</th>
                  <th>Hits</th>
                </tr>
              </thead>
              <tbody id="trafficSourcesBody">
                <tr><td colspan="2">Loading‚Ä¶</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- ========== BADGE & ACHIEVEMENT ANALYTICS ========== -->
<section class="panel tall-panel">
    <div class="panel-header">
      <h2>Badge & Achievement Analytics</h2>
      <span class="panel-subtitle">Member achievements across the community</span>
    </div>
  
    <!-- TOP BADGE METRICS -->
    <div class="metrics-grid" style="margin-bottom: 1.5rem;">
      <div class="metric-card">
        <h3>Total Badges Earned</h3>
        <p id="metricTotalBadges">0</p>
        <span class="metric-meta">All badges issued</span>
      </div>
  
      <div class="metric-card">
        <h3>Active Badge Types</h3>
        <p id="metricActiveBadgeTypes">0</p>
        <span class="metric-meta">Badges available</span>
      </div>
  
      <div class="metric-card">
        <h3>Most Earned Badge</h3>
        <p id="metricTopBadge">‚Äì</p>
        <span class="metric-meta">Top community achievement</span>
      </div>
    </div>
  
    <!-- BADGE DISTRIBUTION CHART -->
    <canvas id="badgeDistributionChart" height="140"></canvas>
  </section>
  
  <!-- TOP EARNERS -->
  <section class="panel tall-panel">
    <div class="panel-header">
      <h2>Top Members by Badges Earned</h2>
      <span class="panel-subtitle">Members who have earned the most badges</span>
    </div>
  
    <table class="analytics-table">
      <thead>
        <tr>
          <th>Member</th>
          <th>Badges</th>
        </tr>
      </thead>
      <tbody id="badgeTopMembersTable"></tbody>
    </table>
  </section>
  
  </div>
</main>

<sctipt src="admin-analytics.js"></sctipt>
<script src="admin-analytics-realtime.js"></script>
</body>
</html>
